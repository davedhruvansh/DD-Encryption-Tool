<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced Encryption Tool</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #0f172a;
    color: #e2e8f0;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  .container {
    background: #1e293b;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0px 0px 20px rgba(123, 97, 255, 0.5);
    width: 450px;
    text-align: center;
  }
  h1 { color: #7b61ff; }
  textarea, input {
    width: 100%;
    margin: 8px 0;
    border-radius: 8px;
    border: none;
    padding: 10px;
    background: #334155;
    color: #fff;
    font-size: 14px;
  }
  button {
    margin: 5px;
    padding: 10px 16px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    background: linear-gradient(90deg,#7b61ff,#00e6a8);
    color: white;
    transition: 0.2s;
  }
  button:hover { transform: scale(1.05); }
  select {
    width: 100%;
    padding: 8px;
    border-radius: 8px;
    background: #475569;
    color: #fff;
    margin-bottom: 10px;
  }
</style>
</head>
<body>
<div class="container">
  <h1>üîê Advanced Encryption Tool</h1>
  
  <select id="method">
    <option value="caesar">Caesar Cipher</option>
    <option value="aes">AES Encryption</option>
  </select>
  
  <textarea id="inputText" placeholder="Enter your text here..."></textarea>
  <input type="password" id="password" placeholder="Password (only for AES)">
  
  <button onclick="encrypt()">Encrypt</button>
  <button onclick="decrypt()">Decrypt</button>
  
  <textarea id="outputText" placeholder="Result..." readonly></textarea>
</div>

<script>
  const shift = 5;

  // Caesar Cipher
  function caesarEncrypt(text) {
    return text.split('').map(ch => String.fromCharCode(ch.charCodeAt(0) + shift)).join('');
  }
  function caesarDecrypt(text) {
    return text.split('').map(ch => String.fromCharCode(ch.charCodeAt(0) - shift)).join('');
  }

  // AES with Web Crypto API
  async function getKey(password) {
    const enc = new TextEncoder();
    const keyMaterial = await crypto.subtle.importKey(
      "raw", enc.encode(password), "PBKDF2", false, ["deriveKey"]);
    return crypto.subtle.deriveKey(
      { name: "PBKDF2", salt: enc.encode("salt123"), iterations: 100000, hash: "SHA-256" },
      keyMaterial, { name: "AES-GCM", length: 256 }, false, ["encrypt", "decrypt"]);
  }

  async function aesEncrypt(text, password) {
    const enc = new TextEncoder();
    const iv = crypto.getRandomValues(new Uint8Array(12));
    const key = await getKey(password);
    const encrypted = await crypto.subtle.encrypt({ name: "AES-GCM", iv }, key, enc.encode(text));
    return btoa(String.fromCharCode(...iv) + String.fromCharCode(...new Uint8Array(encrypted)));
  }

  async function aesDecrypt(text, password) {
    const data = atob(text);
    const iv = new Uint8Array([...data.slice(0,12)].map(ch => ch.charCodeAt(0)));
    const encryptedData = new Uint8Array([...data.slice(12)].map(ch => ch.charCodeAt(0)));
    const key = await getKey(password);
    const decrypted = await crypto.subtle.decrypt({ name: "AES-GCM", iv }, key, encryptedData);
    return new TextDecoder().decode(decrypted);
  }

  async function encrypt() {
    let method = document.getElementById("method").value;
    let text = document.getElementById("inputText").value;
    let password = document.getElementById("password").value;
    let result = "";

    if(method === "caesar") {
      result = caesarEncrypt(text);
    } else {
      if(!password) { alert("Password required for AES!"); return; }
      result = await aesEncrypt(text, password);
    }
    document.getElementById("outputText").value = result;
  }

  async function decrypt() {
    let method = document.getElementById("method").value;
    let text = document.getElementById("inputText").value;
    let password = document.getElementById("password").value;
    let result = "";

    try {
      if(method === "caesar") {
        result = caesarDecrypt(text);
      } else {
        if(!password) { alert("Password required for AES!"); return; }
        result = await aesDecrypt(text, password);
      }
    } catch(e) {
      alert("Decryption failed. Wrong password or text corrupted.");
    }

    document.getElementById("outputText").value = result;
  }
</script>
</body>
</html>
